<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Widget</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#2563EB',
                        secondary: '#F3F4F6',
                        accent: '#10B981'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom scrollbar for chat area */
        .chat-scroll::-webkit-scrollbar {
            width: 4px;
        }
        .chat-scroll::-webkit-scrollbar-track {
            background: transparent;
        }
        .chat-scroll::-webkit-scrollbar-thumb {
            background-color: rgba(156, 163, 175, 0.3);
            border-radius: 2px;
        }
        .chat-scroll::-webkit-scrollbar-thumb:hover {
            background-color: rgba(156, 163, 175, 0.5);
        }

        /* Message animation */
        .message-enter {
            opacity: 0;
            transform: translateY(10px);
            animation: messageEnter 0.2s ease-out forwards;
        }

        @keyframes messageEnter {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Typing indicator animation */
        .typing-dot {
            animation: typingBounce 1.4s infinite;
        }
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingBounce {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-8px);
            }
        }

        /* Send button hover effect */
        .send-button {
            transition: all 0.2s ease-out;
        }
        .send-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        .send-button:active:not(:disabled) {
            transform: scale(0.95);
        }

        /* Input focus effect */
        .message-input:focus {
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
        }
    </style>
</head>
<body class="h-full bg-neutral-50 dark:bg-neutral-800 font-sans">
    <!-- Main Container -->
    <div class="fixed inset-0 flex items-center justify-center p-0 md:p-4">
        <!-- Chat Widget -->
        <div id="chatWidget" class="w-full h-full md:w-[420px] md:h-[80vh] md:rounded-2xl md:shadow-xl overflow-hidden bg-white dark:bg-neutral-900 flex flex-col">

            <!-- Header -->
            <header class="h-14 flex items-center justify-between px-4 border-b border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-900">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="font-semibold text-lg text-neutral-900 dark:text-white">Chat</h1>
                        <div class="flex items-center gap-1">
                            <div class="w-2 h-2 bg-accent rounded-full"></div>
                            <span class="text-xs text-neutral-500 dark:text-neutral-400">Online</span>
                        </div>
                    </div>
                </div>

                <!-- Dark mode toggle -->
                <button id="darkModeToggle" class="p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors">
                    <svg class="w-5 h-5 text-neutral-600 dark:text-neutral-400 dark:hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg class="w-5 h-5 text-neutral-400 hidden dark:block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="5"></circle>
                        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                    </svg>
                </button>
            </header>

            <!-- Messages Area -->
            <div id="messagesContainer" class="flex-1 overflow-y-auto p-4 space-y-3 chat-scroll">
                <!-- Welcome message -->
                <div class="flex justify-center mb-6">
                    <div class="bg-neutral-100 dark:bg-neutral-800 rounded-full px-4 py-2">
                        <span class="text-xs text-neutral-500 dark:text-neutral-400">Today</span>
                    </div>
                </div>

                <!-- Sample initial messages -->
                <div class="flex message-enter">
                    <div class="bg-neutral-100 dark:bg-neutral-700 rounded-2xl px-3 py-2 max-w-[75%]">
                        <p class="text-sm text-neutral-900 dark:text-white">Hello! ðŸ‘‹ Welcome to our chat widget demo.</p>
                        <span class="text-xs text-neutral-400 dark:text-neutral-500 mt-1 block">2:30 PM</span>
                    </div>
                </div>

                <div class="flex message-enter">
                    <div class="bg-neutral-100 dark:bg-neutral-700 rounded-2xl px-3 py-2 max-w-[75%]">
                        <p class="text-sm text-neutral-900 dark:text-white">This is a fully functional chat interface built with Tailwind CSS and vanilla JavaScript.</p>
                        <span class="text-xs text-neutral-400 dark:text-neutral-500 mt-1 block">2:30 PM</span>
                    </div>
                </div>

                <div class="flex justify-end message-enter">
                    <div class="bg-primary text-white rounded-2xl px-3 py-2 max-w-[75%]">
                        <p class="text-sm">That's awesome! I love the design.</p>
                        <div class="flex items-center justify-end gap-1 mt-1">
                            <span class="text-xs text-blue-200">2:31 PM</span>
                            <svg class="w-3 h-3 text-blue-200" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Typing indicator (hidden by default) -->
                <div id="typingIndicator" class="flex hidden">
                    <div class="bg-neutral-100 dark:bg-neutral-700 rounded-2xl px-3 py-2">
                        <div class="flex items-center gap-1">
                            <div class="w-2 h-2 bg-neutral-400 rounded-full typing-dot"></div>
                            <div class="w-2 h-2 bg-neutral-400 rounded-full typing-dot"></div>
                            <div class="w-2 h-2 bg-neutral-400 rounded-full typing-dot"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="flex items-center gap-2 p-3 border-t border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-900">
                <div class="flex-1 relative">
                    <input
                        type="text"
                        id="messageInput"
                        placeholder="Type a message..."
                        class="w-full bg-neutral-100 dark:bg-neutral-800 text-neutral-900 dark:text-white placeholder-neutral-500 dark:placeholder-neutral-400 rounded-full px-4 py-2 text-sm focus:outline-none message-input transition-shadow"
                        maxlength="1000"
                    />
                </div>
                <button
                    id="sendButton"
                    class="bg-primary text-white rounded-full p-3 disabled:opacity-50 disabled:cursor-not-allowed send-button"
                    disabled
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M22 2L11 13"></path>
                        <path d="M22 2L15 22L11 13L2 9L22 2Z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const messagesContainer = document.getElementById('messagesContainer');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');
        const darkModeToggle = document.getElementById('darkModeToggle');

        // State
        let isTyping = false;
        let messageCount = 0;

        // Initialize dark mode
        function initDarkMode() {
            const isDark = localStorage.getItem('darkMode') === 'true' ||
                          (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches);

            if (isDark) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        // Toggle dark mode
        function toggleDarkMode() {
            const isDark = document.documentElement.classList.contains('dark');
            if (isDark) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('darkMode', 'false');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('darkMode', 'true');
            }
        }

        // Format time
        function formatTime() {
            const now = new Date();
            return now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            });
        }

        // Create message element
        function createMessage(text, isOutgoing = true) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex message-enter ${isOutgoing ? 'justify-end' : ''}`;

            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = `rounded-2xl px-3 py-2 max-w-[75%] ${
                isOutgoing
                    ? 'bg-primary text-white'
                    : 'bg-neutral-100 dark:bg-neutral-700'
            }`;

            const textElement = document.createElement('p');
            textElement.className = `text-sm ${isOutgoing ? 'text-white' : 'text-neutral-900 dark:text-white'}`;
            textElement.textContent = text;

            const timeElement = document.createElement('div');
            timeElement.className = `flex items-center gap-1 mt-1 ${isOutgoing ? 'justify-end' : ''}`;

            const timeSpan = document.createElement('span');
            timeSpan.className = `text-xs ${isOutgoing ? 'text-blue-200' : 'text-neutral-400 dark:text-neutral-500'}`;
            timeSpan.textContent = formatTime();

            timeElement.appendChild(timeSpan);

            if (isOutgoing) {
                const checkIcon = document.createElement('svg');
                checkIcon.className = 'w-3 h-3 text-blue-200';
                checkIcon.setAttribute('fill', 'currentColor');
                checkIcon.setAttribute('viewBox', '0 0 20 20');
                checkIcon.innerHTML = '<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>';
                timeElement.appendChild(checkIcon);
            }

            bubbleDiv.appendChild(textElement);
            bubbleDiv.appendChild(timeElement);
            messageDiv.appendChild(bubbleDiv);

            return messageDiv;
        }

        // Auto-scroll to bottom
        function scrollToBottom() {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Show typing indicator
        function showTypingIndicator() {
            if (!isTyping) {
                isTyping = true;
                typingIndicator.classList.remove('hidden');
                scrollToBottom();
            }
        }

        // Hide typing indicator
        function hideTypingIndicator() {
            if (isTyping) {
                isTyping = false;
                typingIndicator.classList.add('hidden');
            }
        }

        // Simulate bot response
        function simulateBotResponse(userMessage) {
            const responses = [
                "That's interesting! Tell me more.",
                "I understand. How can I help you with that?",
                "Thanks for sharing that with me!",
                "That sounds great! What else would you like to know?",
                "I'm here to help. What would you like to do next?",
                "Awesome! Is there anything specific you'd like to discuss?",
                "Perfect! How else can I assist you today?",
                "That makes sense. What other questions do you have?"
            ];

            // Show typing indicator
            showTypingIndicator();

            // Simulate typing delay
            setTimeout(() => {
                hideTypingIndicator();

                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                const botMessage = createMessage(randomResponse, false);

                // Insert before typing indicator
                messagesContainer.insertBefore(botMessage, typingIndicator);
                scrollToBottom();
            }, 1000 + Math.random() * 2000); // Random delay between 1-3 seconds
        }

        // Send message
        function sendMessage() {
            const text = messageInput.value.trim();
            if (!text) return;

            // Create and add user message
            const userMessage = createMessage(text, true);
            messagesContainer.insertBefore(userMessage, typingIndicator);

            // Clear input
            messageInput.value = '';
            updateSendButton();

            // Scroll to bottom
            scrollToBottom();

            // Simulate bot response
            messageCount++;
            if (messageCount % 3 === 0) {
                // Every 3rd message, don't respond to simulate real conversation
            } else {
                simulateBotResponse(text);
            }
        }

        // Update send button state
        function updateSendButton() {
            const hasText = messageInput.value.trim().length > 0;
            sendButton.disabled = !hasText;
        }

        // Event Listeners
        messageInput.addEventListener('input', updateSendButton);

        messageInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                if (!sendButton.disabled) {
                    sendMessage();
                }
            }
        });

        sendButton.addEventListener('click', () => {
            if (!sendButton.disabled) {
                sendMessage();
            }
        });

        darkModeToggle.addEventListener('click', toggleDarkMode);

        // Initialize
        initDarkMode();
        updateSendButton();

        // Focus input on load
        setTimeout(() => {
            messageInput.focus();
        }, 100);

        // Handle window resize for mobile keyboard
        let initialViewportHeight = window.innerHeight;

        window.addEventListener('resize', () => {
            const currentHeight = window.innerHeight;
            const heightDifference = initialViewportHeight - currentHeight;

            // On mobile, if keyboard appears (height reduces significantly)
            if (heightDifference > 150 && window.innerWidth < 768) {
                // Scroll to bottom to ensure input is visible
                setTimeout(scrollToBottom, 300);
            }
        });

        // Accessibility: Announce new messages to screen readers
        const messageAnnouncer = document.createElement('div');
        messageAnnouncer.className = 'sr-only';
        messageAnnouncer.setAttribute('aria-live', 'polite');
        messageAnnouncer.setAttribute('aria-atomic', 'true');
        document.body.appendChild(messageAnnouncer);

        // Function to announce messages (for accessibility)
        function announceMessage(text, isOutgoing) {
            messageAnnouncer.textContent = `${isOutgoing ? 'You sent' : 'Received'}: ${text}`;
        }

        // Add announcement to createMessage function
        const originalCreateMessage = createMessage;
        createMessage = function(text, isOutgoing = true) {
            const element = originalCreateMessage(text, isOutgoing);
            announceMessage(text, isOutgoing);
            return element;
        };
    </script>
</body>
</html>